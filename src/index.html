<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Field Service Tracker</title>
    <base href="/" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
    
    <!-- iOS PWA Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="FSTracker">
    <meta name="format-detection" content="telephone=no">
    
    <!-- Apple Touch Icons for iOS -->
    <link rel="apple-touch-icon" href="icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="72x72" href="icons/icon-72x72.png">
    <link rel="apple-touch-icon" sizes="96x96" href="icons/icon-96x96.png">
    <link rel="apple-touch-icon" sizes="128x128" href="icons/icon-128x128.png">
    <link rel="apple-touch-icon" sizes="144x144" href="icons/icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="192x192" href="icons/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="384x384" href="icons/icon-384x384.png">
    <link rel="apple-touch-icon" sizes="512x512" href="icons/icon-512x512.png">
    
    <!-- Standard favicon and manifest -->
    <link rel="icon" type="image/png" sizes="192x192" href="assets/icons/fst-icon-192x192.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="assets/icons/fst-icon-512x512.png" />
    <link rel="shortcut icon" type="image/png" href="assets/icons/fst-icon-192x192.png" />
    <link rel="manifest" href="manifest.webmanifest" />
    
    <!-- Theme color for mobile browsers -->
    <meta name="theme-color" content="#1976d2" />
    <meta name="msapplication-TileColor" content="#1976d2" />
    
    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <app-root></app-root>
    <noscript
      >Please enable JavaScript to continue using this application.</noscript
    >
    <script>
      // iOS compatibility: Ensure app loads even if service worker fails
      // This prevents iOS Safari from getting stuck during service worker registration
      if (navigator.userAgent.match(/iPhone|iPad|iPod/i)) {
        // Add a timeout to ensure page doesn't hang
        window.addEventListener('load', function() {
          setTimeout(function() {
            // Force render if app hasn't loaded
            var appRoot = document.querySelector('app-root');
            if (appRoot && !appRoot.innerHTML.trim()) {
              console.warn('App may be stuck, attempting recovery...');
            }
          }, 5000);
        });
        
        // Handle service worker errors gracefully on iOS
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.addEventListener('error', function(event) {
            console.warn('Service worker error on iOS:', event);
            // Don't block app loading
          });
        }
      }
    </script>
  </body>
</html>
