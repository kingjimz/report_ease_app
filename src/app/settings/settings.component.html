<div
  *ngIf="showGoalModal"
  class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40"
>
  <div class="bg-white rounded-xl p-4 sm:p-8 w-full max-w-lg relative shadow-lg">
    <button
      (click)="showGoalModal = false"
      class="absolute top-3 right-3 text-gray-400 hover:text-red-600 text-xl"
      aria-label="Close"
    >
      <i class="bi bi-x-lg"></i>
    </button>

    <form class="space-y-4 sm:space-y-5 mt-3" (ngSubmit)="onSubmit()">
      <div>
        <label for="goalTitle" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1"
          >Goal Title</label
        >
        <input
          type="text"
          id="goalTitle"
          name="goalTitle"
          [(ngModel)]="goal_title"
          class="w-full px-3 py-2 sm:px-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-400 focus:outline-none text-sm sm:text-base"
          placeholder="Enter your spiritual goal"
        />
      </div>
      <div>
        <label for="goalDescription" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1"
          >Description</label
        >
        <textarea
          id="goalDescription"
          name="goalDescription"
          [(ngModel)]="goal_description"
          rows="3"
          class="w-full px-3 py-2 sm:px-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-400 focus:outline-none text-sm sm:text-base"
          placeholder="Describe your goal"
        ></textarea>
      </div>
      <div>
        <label for="category" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1"
          >Category</label
        >
        <select
          id="category"
          name="category"
          [(ngModel)]="category"
          class="w-full px-3 py-2 sm:px-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-400 focus:outline-none text-sm sm:text-base"
        >
          <option value="">Select category</option>
          <option value="ministry">Ministry</option>
          <option value="congregation">Congregation</option>
          <option value="other">Other</option>
        </select>
      </div>
      <div>
        <label for="targetDate" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1"
          >Target Date (Optional)</label
        >
        <input
          type="date"
          id="targetDate"
          name="targetDate"
          [(ngModel)]="target_date"
          class="w-full px-3 py-2 sm:px-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-400 focus:outline-none text-sm sm:text-base"
        />
      </div>
      <button
        type="submit"
        class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 rounded-lg transition text-base"
      >
        {{ goalSelected ? 'Update' : 'Add Goal' }}
      </button>
    </form>
  </div>
</div>

<div
  class="max-w-2xl mx-auto bg-white rounded-xl p-4 sm:p-8 lg:mb-6 xl:mb-6"
  style="position: relative; overflow: visible"
>
  <h2 class="text-xl sm:text-2xl font-bold mb-1 flex items-center gap-2">
    <i class="bi bi-bullseye text-indigo-500 text-xl sm:text-2xl"></i>
    Spiritual Goals
  </h2>
  <span class="text-gray-600 text-sm max-w-2xl"> Set and track your spiritual goals. </span>

  <button
    (click)="showGoalModal = true"
    class="fixed right-6 z-[9999] bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-5 rounded-full shadow-lg transition text-base flex items-center gap-2"
    style="bottom: 90px; box-shadow: 0 4px 16px rgba(60, 60, 120, 0.15)"
    aria-label="Add Spiritual Goal"
  >
    <i class="bi bi-plus-lg text-lg"></i>
  </button>

  <div class="flex items-center justify-end mb-4">
    <!-- Filter Dropdown (inline) -->
    <div>
      <label for="goalFilter" class="sr-only">Filter by Category</label>
      <select
        id="goalFilter"
        [(ngModel)]="goalFilter"
        name="goalFilter"
        class="px-3 py-2 border border-indigo-300 rounded-lg focus:ring-2 focus:ring-indigo-400 focus:outline-none text-sm sm:text-base bg-indigo-50 text-indigo-700"
        style="max-width: 200px"
      >
        <option value="">All Categories</option>
        <option value="ministry">Ministry</option>
        <option value="congregation">Congregation</option>
        <option value="other">Other</option>
      </select>
    </div>
  </div>
  <div
    *ngIf="filteredGoals().length === 0"
    class="text-gray-500 text-sm sm:text-base text-center py-6"
  >
    No goals yet. Add your first spiritual goal!
  </div>
  <app-goal-card
    *ngFor="let goal of filteredGoals()"
    [goal]="goal"
    (deleteGoal)="deleteGoal(goal)"
    (editGoal)="editGoal(goal)"
  ></app-goal-card>
  <br />
  <br />
</div>
